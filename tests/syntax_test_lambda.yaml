# SYNTAX TEST "Packages/ESPHome/YAML (esphome).sublime-syntax"
# <- source.yaml.esphome comment


## Lambda mappings

lambda: return id(uri) == "";
# <- meta.mapping.key meta.string string.unquoted.plain.out
#^^^^^ meta.mapping.key meta.string string.unquoted.plain.out
#      ^ - source.c++
#       ^^^^^^^^^^^^^^^^^^^^^ meta.string.yaml source.c++
#       ^^^^^^ keyword.control

lambda: 'return id(uri) == "";'
# <- meta.mapping.key meta.string string.unquoted.plain.out
#^^^^^ meta.mapping.key meta.string string.unquoted.plain.out
#      ^ - source.c++
#       ^^^^^^^^^^^^^^^^^^^^^^^ meta.string.yaml
#       ^ string.quoted.single.yaml punctuation.definition.string.begin.yaml - source.c++
#        ^^^^^^^^^^^^^^^^^^^^^ source.c++
#        ^^^^^^ keyword.control
#                             ^ string.quoted.single.yaml punctuation.definition.string.end.yaml - source.c++

lambda: "return id(uri);"
# <- meta.mapping.key meta.string string.unquoted.plain.out
#^^^^^ meta.mapping.key meta.string string.unquoted.plain.out
#      ^ - source.c++
#       ^^^^^^^^^^^^^^^^^ meta.string.yaml
#       ^ string.quoted.double.yaml punctuation.definition.string.begin.yaml - source.c++
#        ^^^^^^^^^^^^^^^ source.c++
#        ^^^^^^ keyword.control
#                       ^ string.quoted.double.yaml punctuation.definition.string.end.yaml - source.c++

lambda: |-
  #     ^ keyword.control.flow.block-scalar.literal
  #      ^ storage.modifier.chomping-indicator
   return id(uri);
  #^^^^^^^^^^^^^^^ meta.string.yaml source.c++
  #^^^^^^ keyword.control
foo: 1
# <- - source.c++


## Lambda tags

foo: !lambda return id(uri)
#    ^^^^^^^ meta.property keyword.control.directive.tag
#           ^ - source.c++
#            ^^^^^^^^^^^^^^ meta.string.yaml source.c++
#            ^^^^^^ keyword.control
#                          ^ - source.c++

foo: !lambda 'return id(uri)'
#    ^^^^^^^ meta.property keyword.control.directive.tag
#           ^ - source.c++
#            ^^^^^^^^^^^^^^^^ meta.string.yaml
#            ^ string.quoted.single.yaml punctuation.definition.string.begin.yaml - source.c++
#             ^^^^^^^^^^^^^^ source.c++
#             ^^^^^^ keyword.control
#                           ^ string.quoted.single.yaml punctuation.definition.string.end.yaml - source.c++

foo: !lambda "return id(uri)"
#    ^^^^^^^ meta.property keyword.control.directive.tag
#           ^ - source.c++
#            ^^^^^^^^^^^^^^^^ meta.string.yaml
#            ^ string.quoted.double.yaml punctuation.definition.string.begin.yaml - source.c++
#             ^^^^^^^^^^^^^^ source.c++
#             ^^^^^^ keyword.control
#                           ^ string.quoted.double.yaml punctuation.definition.string.end.yaml - source.c++

foo: !lambda |-
  #  ^^^^^^^ meta.property keyword.control.directive.tag
  #          ^ keyword.control.flow.block-scalar.literal
  #           ^ storage.modifier.chomping-indicator
   const id = id(uri);
  #^^^^^^^^^^^^^^^^^^^ meta.string.yaml source.c++
   return id;
  #^^^^^^^^^^ meta.string.yaml source.c++
#  ^^^^^^ keyword.control
foo: 1
# <- - source.c++


## Lambda key with lambda tag

lambda: !lambda return id(uri);
#       ^^^^^^^ meta.property keyword.control.directive.tag
#               ^^^^^^^^^^^^^^^ meta.string.yaml source.c++

lambda: !lambda "return id(uri);"
#       ^^^^^^^ meta.property keyword.control.directive.tag
#              ^ - source.c++
#               ^^^^^^^^^^^^^^^^^ meta.string.yaml
#               ^ string.quoted.double.yaml punctuation.definition.string.begin.yaml - source.c++
#                ^^^^^^^^^^^^^^^ source.c++
#                ^^^^^^ keyword.control
#                               ^ string.quoted.double.yaml punctuation.definition.string.end.yaml - source.c++

lambda: !lambda 'return id(uri);'
#       ^^^^^^^ meta.property keyword.control.directive.tag
#              ^ - source.c++
#               ^^^^^^^^^^^^^^^^^ meta.string.yaml
#               ^ string.quoted.single.yaml punctuation.definition.string.begin.yaml - source.c++
#                ^^^^^^^^^^^^^^^ source.c++
#                ^^^^^^ keyword.control
#                               ^ string.quoted.single.yaml punctuation.definition.string.end.yaml - source.c++

lambda: !lambda |-
  #     ^^^^^^^ meta.property keyword.control.directive.tag
  #             ^ keyword.control.flow.block-scalar.literal
  #              ^ storage.modifier.chomping-indicator
   return id(uri);
  #^^^^^^^^^^^^^^^ meta.string.yaml source.c++
  #^^^^^^ keyword.control
foo: 1
# <- - source.c++


## Unterminated

lambda:
foo: 1
# <- - source.c++

foo: !lambda
foo: 1
# <- - source.c++
